<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Starlight Touch - æ³¥ä»Šå¤©ä¹Ÿæ‰‹ç™¢äº†å—</title>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      margin: 0;
      background: linear-gradient(to right, #ebf1ff, #c1d2f7);
      color: #333;
      text-align: center;
    }
    header {
      background-color: #41537a;
      color: white;
      padding: 1rem;
      font-size: 1.8rem;
    }
    #card-container {
      margin-top: 2rem;
    }
    #idol-card {
      width: 300px;
      height: 400px;
      margin: auto;
      border: 8px solid white;
      border-radius: 20px;
      overflow: hidden;
      box-shadow: 0 6px 25px rgba(0,0,0,0.3);
      background-size: cover;
      background-position: center;
      transition: background-image 0.3s ease-in-out;
    }
    #idol-caption {
      margin-top: 1rem;
      font-size: 1.3rem;
      color: #0288d1;
      font-weight: bold;
    }
    button {
      margin-top: 1.5rem;
      padding: 0.7rem 1.5rem;
      font-size: 1rem;
      border: none;
      background-color: #41537a;
      color: white;
      border-radius: 10px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
      cursor: pointer;
      transition: background-color 0.2s;
    }
    button:hover {
      background-color: #6a7fad;
    }
    #videoCanvas {
      display: none;
    }
     body {
    font-family: "æ¨™æ¥·é«”", "DFKai-SB", serif;
  }
  </style>
</head>
<body>

  <header>ğŸŒŸ Starlight Touchï¼å¿ƒå‹•å¬å–šæ©Ÿ ğŸŒŸ</header>

  <div id="card-container">
    <div id="idol-card" style="background-image: url('/static/cards/normal/è®š1.jpeg');"></div>
    <div id="idol-caption">ä½ ä»Šå¤©æƒ³æŠ½åˆ°èª°ï¼</div>
    <button onclick="nextCard()">âœ¨ é»æˆ‘å¬å–šå°å¡ âœ¨</button>
  </div>

  <video id="webcam" autoplay playsinline width="640" height="480" style="display:none;"></video>
  <canvas id="videoCanvas" width="640" height="480"></canvas>

  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.min.js"></script>

  <script>
    const cardData = [
      { image: '/kpop_card_project/static/cards/normal/è®š1.jpeg', caption: 'è·Ÿè‘—ç¢©å’ªç¬‘ä¸€å€‹ï¼' },
      { image: '/kpop_card_project/static/cards/normal/è®š2.jpeg', caption: 'ä»Šå¤©ä¹Ÿè¦é–‹å¿ƒå”·ï¼' },
      { image: '/kpop_card_project/static/cards/normal/è®š3.jpeg', caption: 'Keep shining, my starï¼' },
      { image: '/kpop_card_project/static/cards/normal/è®š4.jpeg', caption: 'ç¬‘ä¸€å€‹å­ï¼' },
      { image: '/kpop_card_project/static/cards/normal/è®š5.jpeg', caption: 'è·Ÿè‘—å°é¶´ç¬‘ä¸€å€‹ï¼' },
      { image: '/kpop_card_project/static/cards/rare/æ„›å¿ƒ1.jpeg', caption: 'ç”œç”œåœˆé€ä¸ŠğŸ©ï¼' },
      { image: '/kpop_card_project/static/cards/rare/æ„›å¿ƒ2.jpeg', caption: 'æ„›å¿ƒå‚³é€ å¯¶åŒ…æ¥ï¼' },
      { image: '/kpop_card_project/static/cards/rare/æ„›å¿ƒ3.jpeg', caption: 'å¿ƒå¿ƒç›¸å°ä¸åˆ†é›¢ï¼' },
      { image: '/kpop_card_project/static/cards/rare/æ„›å¿ƒ4.jpeg', caption: 'ä½ æ˜¯æˆ‘çš„å°å¹¸é‹ğŸ€ï¼' },
      { image: '/kpop_card_project/static/cards/rare/æ„›å¿ƒ5.jpeg', caption: 'è·Ÿæˆ‘ä¸€èµ·é–ƒé–ƒç™¼å…‰ğŸ’' },
      { image: '/kpop_card_project/static/cards/rare/æ„›å¿ƒ6.jpeg', caption: 'ä½ å€‘æ˜¯æˆ‘çš„è¶…ç´šè‹±é›„ğŸ¦¸â€â™‚ï¸' },
      { image: '/kpop_card_project/static/cards/ultra_rare/è€¶1.jpeg', caption: 'è·Ÿæˆ‘ä¸€èµ·é–ƒé–ƒç™¼å…‰ğŸ’' },
      { image: '/kpop_card_project/static/cards/ultra_rare/è€¶2.jpeg', caption: 'ä½ æ˜¯æˆ‘çš„é–‹å¿ƒæœğŸ‰' },
      { image: '/kpop_card_project/static/cards/ultra_rare/è€¶3.jpeg', caption: 'ä»Šå¤©ä¹Ÿä¸€èµ·åŠ æ²¹å§ğŸ’–' },
      { image: '/kpop_card_project/static/cards/ultra_rare/è€¶4.jpeg', caption: 'æœ‰ä½ çœŸå¥½ï½ï½ğŸ’Œ' },
      { image: '/kpop_card_project/static/cards/ultra_rare/è€¶5.jpeg', caption: 'ä½ æ˜¯æˆ‘æœ€ç”œçš„ç³–ğŸ¬' },
       { image: '/kpop_card_project/static/cards/ultra_rare/è€¶6.jpeg', caption: 'å°ç‹—ä¾†åš•ï¼' },
        { image: '/kpop_card_project/static/cards/ultra_rare/è€¶7.jpeg', caption: 'ä½ æ˜¯æˆ‘çš„æ˜Ÿæ˜Ÿâ­' }

    ];

    let currentIndex = 0;
    let lastTriggerTime = 0;

    function showCard(index) {
      const card = cardData[index];
      document.getElementById('idol-card').style.backgroundImage = `url('${card.image}')`;
      document.getElementById('idol-caption').innerText = card.caption;
    }

    function nextCard() {
      currentIndex = (currentIndex + 1) % cardData.length;
      showCard(currentIndex);
    }

    function isGestureCooldownPassed() {
      const now = Date.now();
      if (now - lastTriggerTime > 2000) {
        lastTriggerTime = now;
        return true;
      }
      return false;
    }

    const videoElement = document.getElementById('webcam');
    const canvasElement = document.getElementById('videoCanvas');
    const canvasCtx = canvasElement.getContext('2d');

    const hands = new Hands({
      locateFile: (file) => `https://cdn.jsdelivr.net/npm/@mediapipe/hands/${file}`
    });

    hands.setOptions({
      maxNumHands: 1,
      modelComplexity: 1,
      minDetectionConfidence: 0.7,
      minTrackingConfidence: 0.7
    });

    hands.onResults((results) => {
      if (results.multiHandLandmarks && results.multiHandLandmarks.length > 0) {
        const landmarks = results.multiHandLandmarks[0];
        const thumbTip = landmarks[4];
        const indexTip = landmarks[8];

        const dx = indexTip.x - thumbTip.x;
        const dy = indexTip.y - thumbTip.y;
        const distance = Math.sqrt(dx * dx + dy * dy);

        if (distance < 0.05 && isGestureCooldownPassed()) {
          nextCard();
        }
      }
    });

    const camera = new Camera(videoElement, {
      onFrame: async () => {
        await hands.send({ image: videoElement });
      },
      width: 640,
      height: 480
    });

    camera.start();

  </script>
</body>
</html>
